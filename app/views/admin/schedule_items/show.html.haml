.row.admin-table-header
  .medium-10.columns
    %h3
      %span.fitness-class-color{ style: "background-color: #{ schedule_item.fitness_class.color }"}
      #{ schedule_item.fitness_class }
      (#{ l(schedule_item.start.in_website_time_zone, format: :human_friendly_date_with_time) },
      #{ t('schedule_item.attributes.capacity') }: #{ schedule_item.capacity })

  .medium-2.columns
    = link_to t('shared.create'),
        new_admin_reservation_path(schedule_item: schedule_item),
        class: 'button action create',
        title: t('shared.create'),
        remote: true

.row
  .medium-12.columns
    %table
      %thead
        %tr
          %th
            = t('user.name')
          %th
            = t('reservation.attributes.queue')
          %th
            = t('reservation.attributes.attended')
          %th
            = t('user.attributes.probability')
          %th
            = t('shared.actions')
      %tbody
        - schedule_item.reservations.order(:created_at).each do |reservation|
          - queue_class = reservation.queued? ? 'queued' : 'active'
          %tr{ id: reservation.decorate.css_id, class: queue_class }
            %td{ data: { label: t('user.name') } }
              = reservation.user

            %td{ data: { label: t('reservation.attributes.queue') } }
              = reservation.queue_position

            %td.status{ data: { label: t('reservation.attributes.attended') } }
              - if reservation.attended?
                %span.action.attended
                  Yes
              - elsif reservation.missed?
                %span.action.missed
                  No
              - else
                %span.action.unknown
                  ?
            %td{ data: { label: t('user.attributes.probability') } }
              - # TODO: implement
              100%

            %td{ data: { label: t('shared.actions') } }
              %ul.actions
                = link_to t('reservation.attend'),
                  admin_reservation_path(reservation, reservation: { status: 'attended' }),
                  method: :put,
                  remote: true,
                  class: 'action attended',
                  title: t('reservation.attend')

                = link_to t('reservation.missed'),
                  admin_reservation_path(reservation, reservation: { status: 'missed' }),
                  method: :put,
                  remote: true,
                  class: 'action missed',
                  title: t('reservation.missed')

                = link_to t('shared.delete'),
                  admin_reservation_path(reservation),
                  method: :delete,
                  data: { confirm: t('shared.confirm') },
                  remote: true,
                  class: 'action delete',
                  title: t('shared.delete')

